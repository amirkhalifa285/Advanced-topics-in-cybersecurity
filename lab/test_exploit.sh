#!/bin/bash

echo "=========================================="
echo "Testing Buffer Overflow Exploit"
echo "=========================================="
echo ""

# Check if server is running
if ! pgrep -x zookd > /dev/null; then
    echo "[!] Server not running. Starting zookd on port 8080..."
    ./zookd 8080 &
    sleep 1
fi

echo "[*] Server status:"
pgrep -l zookd
echo ""

echo "[*] Running exploit..."
echo ""

./exploit-2.py localhost 8080

echo ""
echo "[*] Check if server crashed:"
echo "[*] Look for message: 'Child process XXXX terminated incorrectly, receiving signal 11'"
echo ""

echo "[*] Kernel logs (segfault info):"
dmesg | tail -5
echo ""

echo "=========================================="
echo "Test complete!"
echo "=========================================="
